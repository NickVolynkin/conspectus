# Машинное обучение для предсказания продаж интернет-магазина Ozon.ru

Лид дата сайенс в озоне, потоварное предскзаание спроса
стали пытаться примениить модели не тольк для предсказания спроса, но и для решения других задач

Доклад - продолжение доклада с хайлоад 2018

С тех пор прошел почти год, много нового сделали. 
В первую очередь, сделали исследование по сезонным паттернам поиска товаров, группы сезонных товаров нужно прогрозировать по-разному. Мы научились это делать. 

Новые фияи кросс товарного взаимодействия

Продвинулись в применении моделей для ценоообразования

Решили сделать ручной анализ данных

## Зачем нужно прогнозировать продажи

Чтобы планировать складские мощности, пополнять запасы, не допустить завалов, знать тренды. 
Хотим потоварно прогнозировать спрос на 1,5 миллиона товаров на максимально возможный без потери точности горизонт. 
Почему не скользящее среднее? Потому, что наш прогноз точнее. 

MAE стал выше, да, рынок e-commerce растет, мир меняется, данные устаревают быстрее. Данные за 10 лет никому не нужны, они не дают прироста в качестве. 
3,6 MAE. 
Попробовали линайную регресию. Перепробовали множество моделей, бустинг, на нем и остановились. 
LightDBM. 

Выбираем для кеаждого товара его покупки за случайные 7 моментов времени и фичи (показатели), информация о прошлых продажах, сколько продали в категории за прошлую неделю, за месяц, год, данные ценах конкурентов. 
Доступность. 

Остановлюсь на двух новых вещах. 

## Сезонность

У многих товаров есть повторяющийся из года в год паттерн. Но вручную разметить это нереально. 
Как научить машину понимать сезонность. 
Нужно минимум два года истории, на озоне каждый денб появляется 1000 новинок. Раньше их размечал человек. 

Взяли товары с двухлетней историей, взяли времененные ряды продаж и кластеризовали, вышло 8-9 кластеров. Так мы разметили хотя бы часть товаров. Кластеры очень хорошо инртерпретируемы - новый год, 1 сентября, лето. 
Выделили из этих товаров фичи, для которых не нужны данные о сезонности. 

Обучили классификатор на полученной разметке, он работает на новых товарах. 

### Кластеризация 

Заполнили пропуски во временных рядах, не более месяца подряд пропуск. 
применили standard scaler. 

Попробовали подход применить функцию близости, не получилось.
А потом подсмотрели в одной статье, что кластеризовать временные ряды в пространстве фич. 
Добавили фактор отношения продаж вокруг важных дат (НГ, 8 марта). 



